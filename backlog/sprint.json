{
  "sprintId": "sprint-1769650155",
  "startedAt": "2026-01-28T18:29:15-07:00",
  "status": "completed",
  "item": {
    "id": "FEAT-004",
    "title": "Item dependency support in backlog",
    "sourceBacklog": "backlog.json",
    "steps": [
      "Step 1: No schema enforcement needed — JSON is schemaless. The 'dependsOn' field is simply an optional array of item ID strings (e.g., \"dependsOn\": [\"FEAT-002\"]). Document the convention in the backlog.json template created by cmd_init() (line ~912+).",
      "Step 2: In pick_item() auto-pick path (line ~306-329), before the existing jq filter, build a list of 'done' item IDs from both backlog.json and bugs.json: done_ids=$(jq -r '.items[] | select(.status == \"done\") | .id'). Pass this as a jq variable.",
      "Step 3: Add to the auto-pick jq filter: select(.dependsOn == null or (.dependsOn | all(. as $dep | $done_ids | index($dep) != null))). This skips items whose dependsOn contains any ID not in the done list. Items without dependsOn pass through unchanged.",
      "Step 4: In pick_item() specific-ID path (line ~284-303), if the item has dependsOn, check for unmet dependencies and log_warning listing them, but proceed anyway (user explicitly chose this item).",
      "Step 5: Add circular dependency protection: in auto-pick, if an item's dependsOn contains its own ID, skip it with log_warning. For indirect cycles, the natural behavior is safe — items with unmet deps are simply never picked.",
      "Step 6: Update the example item in cmd_init() template to show: \"dependsOn\": [] (empty array, commented as optional)."
    ],
    "acceptanceCriteria": [
      "Items with `dependsOn: ['FEAT-002']` are skipped by auto-pick if FEAT-002 status is not 'done'",
      "Explicit ID selection (`run FEAT-003`) works even with unmet dependencies (with a warning)",
      "Items without dependsOn are unaffected",
      "Circular dependencies don't cause infinite loops (log error and skip)",
      "Self-referencing dependsOn is detected and skipped",
      "shellcheck passes with no new warnings"
    ],
    "startedAt": "2026-01-28T18:29:15-07:00",
    "status": "passed",
    "completedAt": "2026-01-28T18:34:43-07:00"
  },
  "completedAt": "2026-01-28T18:34:43-07:00"
}
